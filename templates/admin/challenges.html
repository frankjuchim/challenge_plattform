{% extends "base.html" %}
{% block content %}

<h2 class="mb-4">ğŸ› Admin Â· Challenges</h2>

<div class="mb-4">
  <a href="{{ url_for('admin.challenge_new') }}" class="btn btn-primary">
    â• Neue Challenge
  </a>
</div>

{% if challenges|length == 0 %}
<div class="event-card">
  <p class="text-secondary">
    Es wurden noch keine Challenges angelegt.
  </p>
</div>
{% endif %}

<div class="row g-3">

  {% for c in challenges %}
  <div class="col-12">
    <div class="event-card d-flex justify-content-between align-items-center">

      <!-- LINKER BEREICH -->
      <div>
        <h5 class="mb-1">{{ c.title }}</h5>

        {% if c.paused %}
        <span class="badge bg-warning text-dark">
          â¸ pausiert
        </span>
        {% else %}
        <span class="badge bg-success">
          aktiv
        </span>
        {% endif %}
      </div>

      <!-- RECHTER BEREICH: ACTIONS -->
      <div class="d-flex gap-2 flex-wrap">

        <!-- Aufgaben -->
        <a href="{{ url_for('admin.challenge_tasks', cid=c.id) }}" class="btn btn-outline-light btn-sm">
          ğŸ“‹ Aufgaben
        </a>

        <!-- Pause / Fortsetzen -->
        {% if c.paused %}
        <form method="post" action="{{ url_for('admin.challenge_resume', cid=c.id) }}">
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
          <button class="btn btn-success btn-sm">
            â–¶ Fortsetzen
          </button>
        </form>
        {% else %}
        <form method="post" action="{{ url_for('admin.challenge_pause', cid=c.id) }}">
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
          <button class="btn btn-warning btn-sm">
            â¸ Pause
          </button>
        </form>
        {% endif %}

        <!-- LÃ¶schen -->
        <form method="post" action="{{ url_for('admin.challenge_delete', cid=c.id) }}"
          onsubmit="return confirm('Challenge wirklich lÃ¶schen? Alle Aufgaben und Abgaben gehen verloren!');">
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
          <button class="btn btn-danger btn-sm">
            ğŸ—‘ LÃ¶schen
          </button>
        </form>

      </div>
    </div>
  </div>
  {% endfor %}

</div>

<a href="{{ url_for('admin.dashboard') }}" class="text-secondary d-block mt-4">
  â† zurÃ¼ck zum Admin-Dashboard
</a>

{% endblock %}